!
! auto-generated by ops_fortran.py
!
MODULE MULTIDIM_COPY_KERNEL_MODULE
USE OPS_FORTRAN_DECLARATIONS
USE OPS_FORTRAN_RT_SUPPORT
USE ISO_C_BINDING
USE OPS_CONSTANTS


INTEGER(KIND=4) multi_d1
INTEGER(KIND=4) xdim1
#define OPS_ACC_MD1(d,x,y) ((x)*2+(d)+(xdim0*(y)*2))
INTEGER(KIND=4) multi_d2
INTEGER(KIND=4) xdim2
#define OPS_ACC_MD2(d,x,y) ((x)*2+(d)+(xdim1*(y)*2))

contains

!user function
!DEC$ ATTRIBUTES FORCEINLINE :: multidim_copy_kernel
subroutine multidim_copy_kernel(val1, val2)
  IMPLICIT NONE
  REAL   (kind=8), DIMENSION(2) :: val1
  REAL   (kind=8), DIMENSION(2) :: val2
  val2(OPS_ACC_MD2(0,0,0)) = val1(OPS_ACC_MD1(0,0,0))
  val2(OPS_ACC_MD2(1,0,0)) = val1(OPS_ACC_MD1(1,0,0))
end subroutine


#undef OPS_ACC_MD1
#undef OPS_ACC_MD2


subroutine multidim_copy_kernel_wrap( &
& opsDat1Local, &
& opsDat2Local, &
& dat1_base, &
& dat2_base, &
& start, &
& end )
  IMPLICIT NONE
  real(8), INTENT(IN) :: opsDat1Local(*)
  real(8)opsDat2Local(*)
  integer dat1_base
  integer dat2_base
  integer(4) start(2)
  integer(4) end(2)
  integer n_x, n_y

  DO n_y = start(2), end(2)
    DO n_x = start(1), end(1)
      call multidim_copy_kernel( &
      & opsDat1(dat1_base+(n_x-1)*2 + (n_y-1)*xdim1*2), &
      & opsDat2(dat2_base+(n_x-1)*2 + (n_y-1)*xdim2*2) )
    end DO
  end DO
end subroutine
