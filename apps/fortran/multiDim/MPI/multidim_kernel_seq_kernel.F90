!
! auto-generated by ops_fortran.py
!
MODULE MULTIDIM_KERNEL_MODULE
USE OPS_FORTRAN_DECLARATIONS
USE OPS_FORTRAN_RT_SUPPORT
USE ISO_C_BINDING
USE OPS_CONSTANTS


INTEGER(KIND=4) multi_d1
INTEGER(KIND=4) xdim1
#define OPS_ACC_MD1(d,x,y) ((x)*2+(d)+(xdim0*(y)*2))

contains

!user function
!DEC$ ATTRIBUTES FORCEINLINE :: multidim_kernel
subroutine multidim_kernel(val, idx, multi_d0, xdim0)
  IMPLICIT NONE
  REAL(kind=8)   , DIMENSION(1) :: val
  INTEGER(kind=4), DIMENSION(2), INTENT(IN) :: idx

  INTEGER multi_d0
  INTEGER xdim0

  val(OPS_ACC_MD0(0,0,0)) = idx(0)
  val(OPS_ACC_MD0(1,0,0)) = idx(1)
end subroutine


#undef OPS_ACC_MD1


subroutine multidim_kernel_wrap( &
& opsDat1Local, &
& dat1_base, &
& start, &
& end )
  IMPLICIT NONE
  real(8)opsDat1Local(*)
  integer dat1_base
  integer(4) start(2)
  integer(4) end(2)
  integer n_x, n_y

  DO n_y = start(2), end(2)
    DO n_x = start(1), end(1)
      call multidim_kernel( &
      & opsDat1(dat1_base+(n_x-1)*2 + (n_y-1)*xdim1*2), &
       )
    end DO
  end DO
end subroutine
